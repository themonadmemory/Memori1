<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Submit Memory</title>
    <link rel="stylesheet" href="form_styles.css">
    <style>
        /* Votre style CSS reste inchangé */
    </style>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script src="https://cdn.emailjs.com/dist/email.min.js"></script>
</head>
<body>
    <!-- Gif en fond d'écran -->
    <div id="background">
        <iframe src="https://giphy.com/embed/pGa3r86JE5UArWQB7G" frameborder="0" class="giphy-embed" allowFullScreen></iframe>
    </div>

    <!-- Conteneur du formulaire -->
    <div id="form-container">
        <h1>Submit Your Memory</h1>
        <form id="memoryForm">
            <!-- Champ texte pour le corps du texte -->
            <label for="memoryText">Your Memory:</label>
            <textarea id="memoryText" name="memoryText" rows="4" cols="50" required></textarea>
            <p style="font-size: 14px; color: #555;">Please write a memory that corresponds to the provided coordinates. Do not remove the coordinates to ensure your memory is valid.</p>
            <button type="button" id="sendMemoryButton">Send Your Memory</button>
        </form>

        <!-- Bouton de retour à la carte -->
        <a href="index.html">
            <button type="button">Back to Map</button>
        </a>
    </div>

    <script>
        // Initialise EmailJS avec votre identifiant utilisateur
        emailjs.init("user_your_emailjs_user_id");

        // Fonction pour pré-remplir le champ texte avec les coordonnées
        function fillFormWithCoordinates(lat, lng) {
            var memoryText = 'Coordinates: Lat=' + lat + ', Lng=' + lng + ' (' + lat + ', ' + lng + ')';
            $('#memoryText').val(memoryText);
        }

        // Fonction pour envoyer la mémoire par e-mail
        function sendMemory() {
            var memoryText = $('#memoryText').val();

            // Remplacez "service_your_emailjs_service_id" et "template_your_emailjs_template_id" par vos identifiants
            emailjs.sendForm("service_f48v2un", "template_vxz0hml", {
                memoryText: memoryText
            }).then(
                function(response) {
                    console.log('E-mail sent successfully:', response);
                    // Ajoutez ici toute logique supplémentaire après l'envoi réussi
                },
                function(error) {
                    console.log('Error sending e-mail:', error);
                    // Ajoutez ici toute logique supplémentaire en cas d'erreur

                    // Affichez les détails de l'erreur dans une alerte pour un débogage rapide
                    alert('Error sending e-mail: ' + JSON.stringify(error));
                }
            );
        }

        $(document).ready(function() {
            // Récupérer les paramètres d'URL (lat et lng)
            var urlParams = new URLSearchParams(window.location.search);
            var lat = urlParams.get('lat');
            var lng = urlParams.get('lng');

            // Afficher les coordonnées dans le champ texte (peut être masqué si nécessaire)
            if (lat !== null && lng !== null) {
                $('#memoryText').val('Coordinates: Lat=' + lat + ', Lng=' + lng);
            }

            $('#sendMemoryButton').on('click', function() {
                // Appeler la fonction pour envoyer la mémoire
                sendMemory();
            });
        });
    </script>
</body>
</html>
