<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Submit Memory</title>
    <!-- Vos liens CSS et autres scripts restent inchangés -->
    <link rel="stylesheet" href="form_styles.css">
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script src="https://cdn.emailjs.com/dist/email.min.js"></script>
    <script src="email.js"></script>
    <script src="form_script.js"></script>
</head>
<body>
    <!-- Gif en fond d'écran -->
    <div id="background">
        <iframe src="https://giphy.com/embed/pGa3r86JE5UArWQB7G" frameborder="0" class="giphy-embed" allowFullScreen></iframe>
    </div>

    <!-- Conteneur du formulaire -->
    <div id="form-container">
        <h1>Submit Your Memory</h1>
        <form id="memoryForm">
            <!-- Champ texte pour le corps du texte -->
            <label for="memoryText">Your Memory:</label>
            <textarea id="memoryText" name="memoryText" rows="4" cols="50" required></textarea>
            <p style="font-size: 14px; color: #555;">Please write a memory that corresponds to the provided coordinates. Do not remove the coordinates to ensure your memory is valid.</p>
            <button type="button" id="sendMemoryButton">Send Your Memory</button>
        </form>

        <!-- Bouton de retour à la carte -->
        <a href="index.html">
            <button type="button">Back to Map</button>
        </a>
    </div>

    <script>
        $(document).ready(function() {
            var urlParams = new URLSearchParams(window.location.search);
            var lat = urlParams.get('lat');
            var lng = urlParams.get('lng');

            if (lat !== null && lng !== null) {
                // Utilisez '#memoryText' au lieu de '#coordinates' pour remplir le champ texte
                $('#memoryText').val('Lat: ' + lat + ', Lng: ' + lng);
            }

            $('#sendMemoryButton').on('click', function() {
                sendMemory();
            });
        });

        function fillFormWithCoordinates(lat, lng) {
            // Utilisez '#memoryText' au lieu de '#coordinates' pour remplir le champ texte
            var memoryText = 'Coordinates: Lat=' + lat + ', Lng=' + lng + ' (' + lat + ', ' + lng + ')';
            // Vous pouvez ajouter d'autres informations ou instructions ici si nécessaire
            $('#memoryText').val(memoryText);
        }

        function sendMemory() {
            var coordinates = $('#memoryText').val();  // Utilisez '#memoryText' pour obtenir les coordonnées
            var memoryText = $('#memoryText').val();

            emailjs.send("service_f48v2un", "template_vxz0hml", {
                coordinates: coordinates,
                memoryText: memoryText
            }).then(
                function(response) {
                    console.log('E-mail sent successfully:', response);
                    // Ajoutez ici toute logique supplémentaire après l'envoi réussi
                },
                function(error) {
                    console.log('Error sending e-mail:', error);
                    // Ajoutez ici toute logique supplémentaire en cas d'erreur

                    // Affichez les détails de l'erreur dans une alerte pour un débogage rapide
                    alert('Error sending e-mail: ' + JSON.stringify(error));
                }
            );
        }
    </script>
</body>
</html>
